/*******************************************************************************
 * Educational Online Test Delivery System
 * Copyright (c) 2013 American Institutes for Research
 * 
 * Distributed under the AIR Open Source License, Version 1.0
 * See accompanying file AIR-License-1_0.txt or at
 * http://www.smarterapp.org/documents/American_Institutes_for_Research_Open_Source_Software_License.pdf
 ******************************************************************************/

package org.opentestsystem.delivery;

import java.util.List;

import org.opentestsystem.delivery.testreg.domain.FormatType;
import org.opentestsystem.delivery.testreg.domain.ClientEntity;
import org.opentestsystem.delivery.testreg.service.TestRegPersister;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.Cacheable;

public class CachedClientEntity {

    ClientEntity client;

    @Autowired
    TestRegPersister testRegPersister;

    @Cacheable("Testreg.Client")
    public ClientEntity getClient() {
        List<ClientEntity> list = testRegPersister.findAll(FormatType.CLIENT);
        if (list.size() != 1) {
            throw new RuntimeException("There is a problem with Client Configured in the System. Number of Clients Configured is " + list.size());
        }
        client = list.get(0);
        return client;
    }
}
