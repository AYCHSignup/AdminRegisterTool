/*
Educational Online Test Delivery System Copyright (c) 2013 American Institutes for Research

Distributed under the AIR Open Source License, Version 1.0 See accompanying file AIR-License-1_0.txt or at
http://www.smarterapp.org/documents/American_Institutes_for_Research_Open_Source_Software_License.pdf
 */

package org.opentestsystem.delivery.testreg.transformer;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.zip.GZIPInputStream;

import org.springframework.stereotype.Component;

/**
 * Test helper class used to uncompress a GZIPped stream
 * 
 */
@Component
public class GzipUncompressor {

    private static final int BUFFER_SIZE = 4096;

    public byte[] uncompress(File compressedFile) throws IOException {

        GZIPInputStream gzipInStream = new GZIPInputStream(new FileInputStream(compressedFile));

        ByteArrayOutputStream bytesOutStream = new ByteArrayOutputStream();

        byte[] buf = new byte[BUFFER_SIZE];
        int readLen = 0;

        while ((readLen = gzipInStream.read(buf)) > 0) {
            bytesOutStream.write(buf, 0, readLen);
        }

        gzipInStream.close();

        byte[] uncompressedBytes = bytesOutStream.toByteArray();

        bytesOutStream.close();

        return uncompressedBytes;

    }

}
