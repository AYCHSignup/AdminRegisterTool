package org.opentestsystem.delivery.testreg.rest.external.validation;

import org.apache.commons.lang.StringUtils;
import org.opentestsystem.delivery.testreg.rest.external.models.StudentDto;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

/**
 * Created by fairway on 6/21/16.
 */
public class StudentValidator {

    private static final String DATE_FORMAT = "yyyy-MM-dd";

    public static boolean isLessThanOrEqualToLength(String property, int maxLength) {
        return property.length() <= maxLength;
    }

    public static boolean isGreaterThanOrEqualToLength(String property, int minLength) {
        return minLength <= property.length();
    }

    public static boolean isAlphanumeric(String property) {
        return StringUtils.isAlphanumeric(property);
    }

    public static boolean matchesValueInCollection(String property, Iterable<String> collection) {
        for(String x : collection) {
            if(x.equalsIgnoreCase(property)) return true;
        }
        return false;
    }

    public static boolean isNullEmptyOrWhitespace(String property) {
        return property == null || property.trim().isEmpty();
    }

    public static boolean isValidDate(String date) {
        return isValidDate(date, DATE_FORMAT);
    }

    public static boolean isValidDate(String property, String format) {
        Date date = null;
        try {
            SimpleDateFormat dateFormat = new SimpleDateFormat(format);
            date = dateFormat.parse(property);
            if (!property.equals(dateFormat.format(date))) {
                date = null;
            }
        } finally {
            return date != null;
        }
    }

    //End Generally Useful Modifiers

    //Convert from StudentDto to Student
    public static Iterable<String> retrieveValidationErrors(StudentDto studentDto) {
        List<String> errorMessages = new ArrayList<>();

        if(studentDto.getStateAbbreviation().length() != 2) {
            errorMessages.add("State Code");
        }


        return errorMessages;
    }

}
